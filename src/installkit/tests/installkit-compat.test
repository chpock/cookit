# installkit tests - installkit::compat package
#
# Copyright (C) 2024 Konstantin Kushnir <chpock@gmail.com>
#
# This program is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.

if { [lsearch [namespace children] ::tcltest] == -1 } {
    package require tcltest 2
    namespace import -force ::tcltest::*
}

source [file join [tcltest::testsDirectory] helper.tcl]

package require installkit::compat

test installkit::compat-sha1-1 {sha1 proc with empty data} -body {
    binary encode hex [::sha1 ""]
} -result da39a3ee5e6b4b0d3255bfef95601890afd80709

test installkit::compat-sha1-2 {sha1 proc with simple data} -body {
    binary encode hex [::sha1 "a"]
} -result 86f7e437faa5a7fce15d1ddcb9eaeaea377667b8

test installkit::compat-crapvfs-1 {mount/unmount} -body {
    set mnt [::installkit::tmpmount]
    ::crapvfs::mount [info nameofexecutable] $mnt
    ::crapvfs::unmount $mnt
    set ok ok
} -result ok

test installkit::compat-crapvfs-2 {setPassword} -body {
    ::crapvfs::setPassword foo
    set ok ok
} -result ok

# cleanup
::tcltest::cleanupTests
return
